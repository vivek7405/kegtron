(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"/jtX":function(t){t.exports={site:"site__1MWKo"}},"7gvT":function(t,e,o){"use strict";function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}o.r(e),o.d(e,"default",(function(){return c}));var n=o("hosL"),s=(o("Y3FI"),o("/jtX")),a=o.n(s),i=o("jmCe"),l=o("IMbM"),c=function(t){function e(e){var o;return(o=t.call(this,e)||this).kegLevel=function(t){return t.volSize?+(100*(t.volStart-t.volDisp)/t.volSize).toFixed(2):0},o.mlToUnits=function(t,e){return e?(t/1e3).toFixed(2)+" L":(t/3785.41).toFixed(2)+" gal"},o.th=function(t,e,s){var a=r(o);return Object(n.h)("th",{style:void 0===e?"":"cursor: pointer",class:s||"",onClick:function(){void 0!==e&&a.setState({sortColumn:e,direction:a.state.sortColumn==e?-1*a.state.direction:1})}},t)},o.getBar=function(t,e){var o="";return t.lowThreshold>0&&e<t.lowThreshold&&(o=" bg-warning"),t.emptyThreshold>0&&e<t.emptyThreshold&&(o=" bg-danger"),e<0&&(o=" text-danger"),Object(n.h)("div",{class:"progress mt-1",style:"min-width: 8em"},Object(n.h)("div",{class:"progress-bar"+o,style:"width:"+(e<0?0:e)+"%",role:"progressbar"},Object(n.h)("span",{class:"px-2"},e,"%")))},o.getKegs=function(){var t=r(o),e=t.props.app.state.devices,n=[],s=function(o){var r=e[o],s=r.shadow.state.reported,a=s.config;if((a.siteName||i.a.defaultSiteName)==t.props.name)for(var l=0;l<a.portCount;l++)a["port"+l].d=r,a["port"+l].port=l,a["port"+l].r=s,n.push(a["port"+l])};for(var a in e)s(a);return n.sort((function(e,o){var r=e.userName,n=o.userName;return 1==t.state.sortColumn?(r=e.r.online,n=o.r.online):2==t.state.sortColumn?(r=t.kegLevel(e),n=t.kegLevel(o)):3==t.state.sortColumn?(r=e.volDisp,n=o.volDisp):4==t.state.sortColumn?(r=e.volStart-e.volDisp,n=o.volStart-o.volDisp):5==t.state.sortColumn?(e.drinkSize>0&&(r=(e.volStart-e.volDisp)/e.drinkSize),o.drinkSize>0&&(n=(o.volStart-o.volDisp)/o.drinkSize)):6==t.state.sortColumn&&(r=e.volSize,n=o.volSize),r==n?e.userName>o.userName?1:-1:r>n?1*t.state.direction:-1*t.state.direction})),n},o.state={sortColumn:2,direction:1},o}var o,s;s=t,(o=e).prototype=Object.create(s.prototype),o.prototype.constructor=o,o.__proto__=s;var c=e.prototype;return c.componentDidMount=function(){this.props.app.setState({headerName:"Sites / "+this.props.name,backlink:"/sites"}),this.props.app.state.devices&&0===Object.keys(this.props.app.state.devices).length&&this.props.app.state.devices.constructor===Object&&l.a.getDevices(this.props.app)},c.render=function(){var t=this,e=t.getKegs();return Object(n.h)("div",{class:a.a.site},Object(n.h)("div",{class:"overflow-auto p-2"},Object(n.h)("div",{class:"h-100"},Object(n.h)("table",{class:"w-100 table table-borderless table-sm mt-2"},Object(n.h)("tr",{class:"small border-bottom"},t.th("Name",0),t.th("Status",1),t.th("Level",2,"w-25"),t.th("Vol Served",3),t.th("Vol Remain",4),t.th("Servings Remain",5),t.th("Size",6),Object(n.h)("th",null)),e.map((function(e){var o=e.volStart-e.volDisp,r=t.kegLevel(e),s=e.drinkSize?parseInt(o/e.drinkSize):0,a=e.r,i=a.config.displayUnits||0,l=t.getBar(a.config,r);return Object(n.h)("tr",{},Object(n.h)("td",null,Object(n.h)("a",{href:"/sites/"+t.props.name+"/"+e.d.id+"/"+e.port},e.userName||"Port "+(e.port+1))),Object(n.h)("td",{class:a.online?"text-success":"text-danger"},Object(n.h)("b",null,a.online?"online":"offline")),Object(n.h)("td",null,l),Object(n.h)("td",null,t.mlToUnits(e.volDisp,i)),Object(n.h)("td",{class:o<=0?"bg-danger text-light":""},t.mlToUnits(o,i)),Object(n.h)("td",{class:s<=0?"bg-danger text-light":""},s),Object(n.h)("td",null,t.mlToUnits(e.volSize,i)),Object(n.h)("td",null,Object(n.h)("a",{href:"/config/"+t.props.name+"/"+e.d.id+"/"+e.port},Object(n.h)("span",{class:"fa fa-cog"}))))}))))))},e}(n.Component)},IMbM:function(t,e,o){"use strict";o.d(e,"a",(function(){return s}));var r=o("jmCe"),n=o("czhI").default,s=function(){};s.getDevices=function(t){n.get(r.a.mdashURL+"/customer?access_token="+localStorage.ktok).then((function(e){var o={},s=Object.keys(e.data.pubkeys||{}).map((function(t){var e=r.a.mdashURL+"/api/v2/m/device?access_token="+encodeURIComponent(t);return n({method:"GET",url:e}).then((function(e){o[t]=e.data})).catch((function(){}))}));Promise.all(s).then((function(){t.setState({devices:o})}))}))},s.getAllServings=function(t){n.get(r.a.mdashURL+"/customer?access_token="+localStorage.ktok).then((function(e){var o={},s=e.data.pubkeys||{},a=Object.keys(s).map((function(t){var e=r.a.mdashURL+"/api/v2/m/device/data/servings_all?access_token="+encodeURIComponent(t);return n({method:"GET",url:e}).then((function(e){o[t]=e.data})).catch((function(){}))}));Promise.all(a).then((function(){t.setState({servings:o,pubkeys:s})}))}))}},jmCe:function(t,e){"use strict";e.a={baseURL:"http://localhost:8080/",provisionURL:"http://192.168.4.1",mdashURL:"https://mdash.net",appID:"",callTimeoutMilli:1e4,defaultSiteName:"NewSite",drinkSizes:{1e3:"Liter (1000 mL)",500:"Half Liter (500 mL)",651:"Bomber (651 mL)",568:"UK Pint (568 mL)",473:"US Pint (473 mL)",355:"US Bottle (355 mL)",0:"Custom"},drinkSizes_US:{1e3:"Liter (33.8oz)",500:"Half Liter (16.9 oz)",651:"Bomber (22.0 oz)",568:"UK Pint (19.2 oz)",473:"US Pint (16 oz)",355:"US Bottle (12 oz)",0:"Custom"},kegSizes:{9464:"Half Corny (9.5L)",18927:"Corny (18.9L)",19550:"1/6 Barrel (19.6L)",2e4:"20L",25e3:"25L",29340:"1/4 Barrel (29.3L)",3e4:"30L",40915:"Firkin (40.9L)",5e4:"50L",58670:"1/2 Barrel (58.7L)",0:"Custom"},kegSizes_US:{9464:"Half Corny (2.5 gal)",18927:"Corny (5 gal)",19550:"1/6 Barrel (5.16 gal)",2e4:"20L (5.28 gal)",25e3:"25L (6.6 gal)",29340:"1/4 Barrel (7.75 gal)",3e4:"30L (7.93 gal)",40915:"Firkin (10.81 gal)",5e4:"50L (13.21 gal)",58670:"1/2 Barrel (15.5 gal)",0:"Custom"}}}}]);
//# sourceMappingURL=route-site.chunk.e74ad.js.map